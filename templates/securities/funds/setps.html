{% extends "securities/funds/detail.html" %}
{% block main_block %}
<div class="container">
	<form id="form" role="form" class="col-md-offset-2 col-md-8">
		<div class="form-group">
			<label class="form-label col-sm-3">用户名</label>
			<div class="input-group col-md-9">
				<input type="text" name="username" class="form-control form-login">
			</div>
		</div>
		<div class="form-group">
			<label class="form-label col-sm-3">密码</label>
			<div class="input-group col-sm-9">
				<input type="password" name="password" class="form-control form-login">
			</div>
		</div>
		<div class="container">
		<div class="alert alert-danger alert-login"></div>
		</div>
		<div class="form-group">
			<div class="col-sm-12">
			<input type="submit" value="提交" class="btn btn-login" >
			</div>
		</div>
	</form>
</div>
{% endblock %}
{% block extra_script %}
{{block.super}}
<script type="text/javascript">
$(function(){
	var $form = $("#form");
	$form.validate({
		rules:{
			username: {
				required: true,
				minlength: 4,
			},
			password: 'required'
		}
	});
	$form.submit(function(){
		$form.validate();
		if (!$form.valid()) return false;
		API.url("funds").id(window.uid).url("account").post($form.serializeObject())
		.ok(function(data){
			window.location.href = '/accounts/profile/?uid='+data.id;
		}).
		paramError(function(data){
			for (var err in data){
				$("input[name='"+err+"']").error();
				$form.placeError(data[err][0]);
			}
		});
	});
});
</script>
{% endblock %}
{% block sidebar %}{% endblock %}
